<?php
$moves = [[1, 1], [3, 1], [5, 1], [7, 1], [1, 2]];
$trees = [];
foreach (range(0, count($moves) - 1) as $index) {
  $trees[$index] = 0;
}

$slope = [
  '.#..#....##...#....#.....#.#...',
  '........##....#..#..##....#.#..',
  '......##......##.........#....#',
  '...#.....#....##.......#.#....#',
  '.#.###.#.#..#.....##..#....#.#.',
  '##.........##.....####......#..',
  '#...#..........#.##............',
  '####............#..........#.#.',
  '......#......#....##...#..##...',
  '#..#....#...#......#......####.',
  '......#..........#.........#.#.',
  '...##.......#..#.#..#..#....#..',
  '..####....#.#...............##.',
  '...###........#.....#..........',
  '#..#.##...##.#..##...##...#....',
  '.###........#.##..#.#.....#....',
  '.#.......#..##.......#......#..',
  '.##...........#..............#.',
  '...#..#.....#...........#...#..',
  '.....#..............#..#.......',
  '.......#....#.....##...........',
  '.#...#.............#.....##....',
  '....#.#....#...#...#..#..##.#..',
  '...#..##..##...#..##........#.#',
  '.###..#...#.#.#.#..#...#.......',
  '.....##.#.##.#.#.......#..#....',
  '.##.#...#.....#...#....#.....#.',
  '.....#......###....###..##.#..#',
  '.....#..##....#..#.#..#.#.#....',
  '#....#.....#.#.......#...#....#',
  '...#........#............#..#..',
  '#.#...#...#..##.........#...##.',
  '.#..#.#...........#....#...#...',
  '##..#.#..........#.....###...#.',
  '#..#........#.......#.#..#....#',
  '..#...##....#..#....#....#.....',
  '...#.....##....#...#..#....##.#',
  '.....#......#...#.#.#.#.#......',
  '###.....#..#.#..........##.#...',
  '...............#..#...#.#....#.',
  '#.....#.....###....#..........#',
  '........#...#.#.......#..#...#.',
  '..#.##...#...#...#.........#...',
  '#..........#..#.#...........##.',
  '##.......#.#.#...#.....#.......',
  '...#.#.#.....#......#....##..#.',
  '##.#.....#....#...#.......#....',
  '.#......##..#.##.#....##..##.#.',
  '..#..#......#....#...#..#.#....',
  '...#..###...#.......#..#.......',
  '...#....#..#....#........##....',
  '#...#...#....#.#.........###.#.',
  '.#.........##..##...#..........',
  '...##.....##.........#..#..#...',
  '###....#......#.##..#...#......',
  '.###....#.#.......#..#....#...#',
  '....####........##....#.#....##',
  '..#.....#......##...#..#..#....',
  '...#....#...#......#.###.#.#.#.',
  '......#.......#..#...#...#.....',
  '.#...#...#..#.#..........#.....',
  '........#..#.........#.#....##.',
  '.#....#.......#........#.##.#..',
  '...#...#..#.....#......#...##..',
  '.#.................#........###',
  '.......#.#..#.#...#............',
  '.#.......#..##...#.###....#.##.',
  '#........#.###.#..#........##..',
  '..##.#....##......##........#..',
  '...............#...............',
  '#.......#......##..#.#....#.#.#',
  '..#.....#......#.#.#...#...##..',
  '..........#........#.....##...#',
  '#..........#.#..#..##..#......#',
  '.......#..###..##.#..##........',
  '#.#..##..###..#.###.....#.#..##',
  '..#.#........#...###...##......',
  '.......##.....##...#.##........',
  '.#.#...###..#..#......##....##.',
  '#...#.#.....##..#..#..#.#....#.',
  '........#......#....#..#.......',
  '...#.#.#.#........###....#...#.',
  '.#......#...#.......#......#...',
  '#...#.##.#..#.#..#.........#...',
  '....#......##......#........#.#',
  '..##.#.....#..#......#..#......',
  '#.##...##...#................#.',
  '.....#..#....#....#####........',
  '....#..#..#.#...#.#............',
  '.........#.#....#..#....##...#.',
  '#....#..........#......#......#',
  '.......#..............#......#.',
  '.#..#...#..#.#.....#.#.#.##.#..',
  '.##........#......#...#.##.....',
  '...#.##..#........#...........#',
  '..#...#..#........#.......#.#..',
  '#.....#..#.#..#..#...#...#..#..',
  '..................#.#.....#...#',
  '........#...##.#..#.........#..',
  '.#...##.#...........##.##...#..',
  '#......#.........#...#...#...#.',
  '..........#.............#...#..',
  '#............##.#..#...#.#...#.',
  '..#.##...##....##.#...####...#.',
  '#.##..#......#.......#.#...##..',
  '.....#...#..#......#####.##..#.',
  '#...#.#.##..#..##.....#......#.',
  '.#..#......#.#.#...#.#...##.#..',
  '.#.....#..##........#.....#...#',
  '.................#..........#..',
  '##.#.#......#.####..#.....#....',
  '.#...##.####..#...#............',
  '..#...............###....#....#',
  '#...#..###..#.#.##...........##',
  '...................#..#.....#..',
  '...#.##.#...#.....#......#.##..',
  '#.#...#.........##.#........#.#',
  '.##.......#..#..#.....##....#..',
  '......##.#.#..#...#.#..##.....#',
  '..#..###...#...#......#.#......',
  '..##....#.#...#....#....#..#..#',
  '#..##....#........#..##..#..#.#',
  '.......#............#....##..#.',
  '.#.#..#.........#.#.##......#..',
  '#.#....#..##..#..###.#.....##..',
  '.###.#......#.....#####...#....',
  '#...#.#...##......#...#.#...##.',
  '#..#.........#..#............#.',
  '...##......##.......##....##...',
  '...#...##....###..###.#...#....',
  '#.#....#...#.#...##..#........#',
  '.#..#..................#....#..',
  '#......#..#...##..##...#..##..#',
  '...#..#.....#...#........#.#.#.',
  '#...#..##....#.....#........#..',
  '.##..#....#.....#.#............',
  '##..##.#.#.##.#.#..#.#..#....#.',
  '#.......#...............#.....#',
  '..#.....#..##.....#...##.##....',
  '...#..#...#.#.#....#......#....',
  '###.#.......#....#....#.#...#..',
  '.....###..#...###.#.#..#.......',
  '.....#.........##.#....#..##.#.',
  '........#....#....#....#.#..##.',
  '........###....#.#.........#.#.',
  '.#..###..#........#.......##.#.',
  '.#.#...........................',
  '..#....##...#.#....#....#.#....',
  '.#...#...##.#........###....#..',
  '#.#....#...#.#.#...##......##..',
  '#......#....#...#..#....#...#..',
  '...#..##........#.#...##......#',
  '....##...........##...#..#..#..',
  '......#..#........#..#....##.##',
  '.###..#.#.........#.....#......',
  '.#..##............#......#.....',
  '..##.#.#..#..#.###....#..#..#..',
  '....#.#..#.#..##...##.#.#.#.#..',
  '....#..#....#...............#..',
  '..#...#.##.....##....#..##..#..',
  '.......##.#....#.##....#.......',
  '.#...#........#...#......#.###.',
  '..#....##.......#....#.#...#.#.',
  '.....#.....#...##..#....#.#..##',
  '..##........##............##...',
  '..........#...#.......#.......#',
  '.#...............#...#.##......',
  '#.##......#....#.##.#..#..#...#',
  '......###.........#...#..#....#',
  '....#......#...#....#....#...#.',
  '#...##...#....#......####....#.',
  '.................#......#......',
  '..#..........##.......##..#.##.',
  '.#.....#.......#...######..#..#',
  '....##.#...#...#..........#....',
  '.....#.......#...#.#.......###.',
  '#...#.###.....#...#.......#....',
  '.#.##.####....#.....#.#........',
  '.......#.....##............##..',
  '..#...#.#.##........#...##...#.',
  '........#...####.##..#....#...#',
  '#.......#...##.#......#..#...#.',
  '......#.........#..###.#.#....#',
  '#..##...#...#..#...#...#.....#.',
  '.#...#...#.#.................##',
  '#......#.....#..#.#..#......##.',
  '.......#.##...#.......#.......#',
  '.#.#..#..#......#....#.#...#.#.',
  '..#...#.#..#......#...#.#.#....',
  '........#..............#..##...',
  '.##..#..##.#....#.#..###..#..#.',
  '..#....#......#...#.#.#....#...',
  '...#..#..#....#..#.....##......',
  '.#......#...#........##........',
  '.#......#..#...##..#..#.#.#....',
  '.##......#.##.........#....#...',
  '....#....##..#..###.#..#......#',
  '....#....##..........#.#...#...',
  '..##.#.............#..#.....#..',
  '..#.....#....#....#.......##...',
  '.##.#....#....#...#....##.#....',
  '...#.#..#.###.#..#.#.......#.#.',
  '.....##.....#.......#......#...',
  '.#.....#..#.#.#..#........##...',
  '##.....................#.......',
  '..###............#........##..#',
  '.#.##.....#..#..#..#.#.......#.',
  '.##...................#..#..#..',
  '..#.#...#..........##..#..##...',
  '#......#..#..#.#..#......#..#.#',
  '.#...#....#.#.........#.....#.#',
  '#..........#.#....#....#.#.#.#.',
  '#.....#..........#..#....#..#..',
  '........#....#..##.#.#.......#.',
  '.#.......##.......#..##...#....',
  '...#..##..#......##.#..#.#..#..',
  '.#..#.......#..##..#......#....',
  '###.#.........#......#.#.......',
  '...#......#....#..##..#.#..#...',
  '......#..#.....#.........#....#',
  '....#..#..#..#.........##.#..#.',
  '......#..#..#..#....#...#..##.#',
  '......##.#..#..#.#.......#.#.##',
  '..#.....#...#..#....#..........',
  '.##..##.....##.......#.##.#....',
  '...#..#.......#..#.......#.....',
  '.........#....##..#.#....#.#...',
  '.....#..#...#.........#....#..#',
  '.........##.....#.#...#.###...#',
  '.#......####..##...#..#........',
  '.#......##....#.....#..........',
  '##.......##.#.......#..........',
  '.#......#.#.#.#....#........#..',
  '......##..##...#...#...........',
  '.#...#.#..#......#.#.#.#....#.#',
  '...#.........#.....#...###.....',
  '#.....##....#.##...#....#......',
  '.#..#...#..##.###.#.#.#...#....',
  '...#......#..#....#...#...#....',
  '.#..............#.....#........',
  '..##...#.....#..#.....#..#.#...',
  '.##...#....#.##...#.........##.',
  '..#......#...##..#.....#......#',
  '#.#..............#...#...#..#.#',
  '..#..#.#...........#...#.#.#...',
  '#..........#...#..#..##..#....#',
  '............#...#........###...',
  '.........#.....#.....#..#......',
  '#...#.#..##......#.#####.......',
  '...#........#..............#...',
  '......###.#.#.....#..#....##.#.',
  '.#.#.#..##....###.#..#....##...',
  '.#....#.##............##.#.....',
  '##...##.#......#.#.##.##...###.',
  '.......#.#........#.....#......',
  '....#.....#......#...#.#..#....',
  '.#.........#....#...#...#...#.#',
  '#.......#................#..#..',
  '.##...........#.##...##....#...',
  '#...#.#...###.........#.......#',
  '.#...#.........................',
  '#.......#...#.....##.##...##...',
  '.#.#....#.......#.#.##.#....#..',
  '#..#....#...#.#.##.#....#....#.',
  '.##.....#.#..#...#..#..........',
  '.............#...#.#..#........',
  '....#........#..#......##......',
  '#.....#....#.....#.......#.....',
  '........#.......##....#........',
  '.#.#..##.......................',
  '##..#.....#........#.....#.....',
  '.#......#.#...#.#..........#..#',
  '.#..#.....#..#..........#.###..',
  '......#.#..#.#.......#.#.....#.',
  '.#....#......#..##.............',
  '#...##.........#.#.#...#.....#.',
  '..#................#..#..###...',
  '#.....#....##.#..##......#.#.#.',
  '..#....#...#...#...............',
  '#................#....#...#.#..',
  '................#...#.....#.##.',
  '..#.#.#..#.##.......##.......##',
  '...........#......##.......###.',
  '...#.......##.........#.#.#.#..',
  '.#...#.#..#...#.#.....#........',
  '............#####......##......',
  '....###....#.##...#..#.........',
  '..#.#...#.......#...#...#.###..',
  '..............##..#...#....#...',
  '#.#..##...#....##.........#....',
  '..#...#.....#...........#...#..',
  '#.#..###..#.#..#........#..#.#.',
  '...###...##...#...#.#.........#',
  '..#........#.....#.#.#.......#.',
  '...#..#..........#.....#...#...',
  '....#..#.....#....##....#.##...',
  '.....##..#...#.#..##...#...##.#',
  '...........###...##....#.......',
  '##..#.#..#..#...#....##..#..#..',
  '##...#.#......##.#..#...#....#.',
  '.#.......#...........#...#.....',
  '#...#....#.......#...#.##......',
  '.........#.......#...#.#...#...',
  '.......##.#..................#.',
  '........#..#.#......#.....#....',
  '.....#.#.#.#....##...#.###.....',
  '#.#.........#..#.#.#.#.#.......',
  '.............#....#.......###..',
  '.#.##....#....##.........####..',
  '...........###.#...............',
  '#.........##.#.#..#.....##.###.',
  '.#.#.....#.#...#.....##...#...#',
  '#....#...#.........#.#.......#.',
  '.....#.###..#....#...##..#...#.',
  '#........#....#.#..#....#.#....',
  '#.#..##......#.........#.#.....',
  '##..#.....#......###....#....#.',
  '#.#.####..#.#.#......##...#..#.',
  '....#.....#.#.#.#.....#........',
  '..##..........#......#.#.#..#..',
  '.#...##.##.........#.........##',
  '..#.#.#..........#..#..#......#',
  '###..###..#...#................',
];

$slopes = [
  '..##.......',
  '#...#...#..',
  '.#....#..#.',
  '..#.#...#.#',
  '.#...##..#.',
  '..#.##.....',
  '.#.#.#....#',
  '.#........#',
  '#.##...#...',
  '#...##....#',
  '.#..#...#.#',
];

collect($moves)->each(function ($move, $index) use ($slope, &$trees) {
  $posX = 0;
  $posY = 0;
  $repeat = strlen($slope[0]);
  $right = $move[0];
  $down = $move[1];

  collect($slope)->each(function ($line) use (
    $slope,
    &$posX,
    &$posY,
    &$trees,
    $repeat,
    $right,
    $down,
    $index
  ) {
    if ($posX >= $repeat) {
      $posX -= $repeat;
    }

    if ($posY > count($slope)) {
      return;
    }

    if ($slope[$posY][$posX] === '#') {
      $trees[$index]++;
    }

    $posY += $down;
    $posX += $right;
  });
});

collect($trees)->reduce(function ($item, $carry) {
  return $item * $carry;
}, 1);
